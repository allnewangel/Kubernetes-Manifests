apiVersion: apps/v1beta2
kind: Deployment
metadata:
    labels:
        app: prometheus-operator
        type: custom
        facing: internal
    name: prometheus-operator
    namespace: {{ prometheus_namespace }}
spec:
    replicas: 1
    selector:
        matchLabels:
            app: prometheus-operator
    template:
        metadata:
            labels:
                app: prometheus-operator
        spec:
            containers:
            - args:
              - --kubelet-service=kube-system/kubelet
              - --logtostderr=true
              - --config-reloader-image=quay.io/coreos/configmap-reload:v0.0.1
              - --prometheus-config-reloader=quay.io/coreos/prometheus-config-reloader:v0.28.0
              image: quay.io/coreos/prometheus-operator:v0.28.0
              name: prometheus-operator
              ports:
              - containerPort: 9090
                name: http
              resources:
                  limits:
                      cpu: 200m
                      memory: 200Mi
                  requests:
                      cpu: 100m
                      memory: 100Mi
              securityContext:
                  allowPrivilegeEscalation: false
                  readOnlyRootFilesystem: true
            nodeSelector:
                beta.kubernetes.io/os: linux
            securityContext:
                runAsNonRoot: true
                runAsUser: 65534
            serviceAccountName: prometheus-operator
  
